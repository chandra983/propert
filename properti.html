<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Properti Dijual - Malang Property Hub</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Poppins', 'sans-serif'] },
                    colors: {
                        primary: '#1e3a8a',
                        secondary: '#f59e0b',
                        'btn-green': '#4d7c0f',
                    },
                    boxShadow: { 'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)' }
                }
            }
        }
    </script>
    
    <style>
        body { padding-top: 0; background-color: #f3f4f6; }
        select {
            -webkit-appearance: none; appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat; background-position: right 0.7rem center; background-size: 1em;
        }

        @media (max-width: 768px) {
            .page-header {
                max-height: 180px;
            }
        }
    </style>
</head>
<body class="text-gray-800 flex flex-col min-h-screen">

    <nav class="fixed top-0 w-full z-50 text-white py-4 bg-primary/95 backdrop-blur shadow-lg transition-all duration-300">
        <div class="container mx-auto px-6 flex justify-between items-center relative">
            <div class="flex items-center gap-3 font-bold text-xl md:text-2xl cursor-pointer">
                <img src="https://cdn-icons-png.flaticon.com/512/609/609803.png" alt="Logo" class="w-10 h-10 bg-white rounded p-1 shadow-sm object-contain">
                <span class="leading-none"><a href="index.html">Malang <br><span class="text-secondary text-sm md:text-lg">Property Hub</span></a></span>
            </div>
            <div class="hidden md:flex gap-8 text-sm font-medium items-center">
                <a href="index.html" class="hover:text-secondary transition py-2">Beranda</a>
                <a href="properti.html" class="text-secondary transition py-2">Properti</a>
                <a href="layanan.html" class="hover:text-secondary transition py-2">Jasa & Layanan</a>
                <a href="blog.html" class="hover:text-secondary transition py-2">Artikel & Blog</a>
                <a href="contact.html" class="hover:text-secondary transition py-2">Kontak</a>
                <a href="https://wa.me/6281234567890" target="_blank" class="bg-secondary hover:bg-yellow-600 text-white text-sm font-semibold py-2.5 px-6 rounded-lg transition shadow-md">
                    Hubungi Agen
                </a>
            </div>
            <button id="mobile-btn" class="md:hidden text-2xl focus:outline-none"><i class="fa-solid fa-bars"></i></button>
        </div>
        <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 w-full bg-primary border-t border-white/10 shadow-xl transition-all duration-300 ease-in-out">
            <div class="flex flex-col p-6 gap-4 font-medium">
                <a href="index.html" class="block hover:text-secondary hover:pl-2 transition-all">Beranda</a>
                <a href="properti.html" class="block text-secondary hover:pl-2 transition-all">Properti</a>
                <a href="layanan.html" class="block hover:text-secondary hover:pl-2 transition-all">Layanan</a>
                <a href="blog.html" class="block hover:text-secondary">Artikel</a>
                <a href="contact.html" class="block hover:text-secondary hover:pl-2 transition-all">Kontak</a>
                <hr class="border-white/20">
                <a href="https://wa.me/6281234567890" target="_blank" class="block text-center bg-secondary hover:bg-yellow-600 text-white py-3 rounded-lg font-bold">
                    Hubungi Agen
                </a>
            </div>
        </div>
    </nav>

    <header class="page-header relative h-[350px] mt-16 flex items-center justify-center text-center bg-fixed bg-cover bg-center" style="background-image: linear-gradient(to right, rgba(30, 58, 138, 0.7), rgba(30, 58, 138, 0.4)), url('https://images.unsplash.com/photo-1564013799919-ab600027ffc6?auto=format&fit=crop&q=80&w=2000');">
        <div class="relative z-10 container mx-auto px-6 text-white">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">Properti Dijual</h1>
            <p class="text-gray-200 text-sm md:text-base max-w-3xl mx-auto leading-relaxed mb-6 font-light">
                Temukan berbagai pilihan properti dijual di Kota Malang, Batu, dan sekitarnya.
            </p>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            
            <aside class="lg:col-span-1 space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-soft sticky top-24">
                    <h3 class="font-bold text-lg mb-4 text-gray-800 border-b pb-2">Filter Pencarian</h3>
                    
                    <div class="mb-5">
                        <label class="block text-xs font-bold text-gray-500 uppercase tracking-wide mb-2">Kata Kunci / Lokasi</label>
                        <div class="relative">
                            <i class="fa-solid fa-magnifying-glass absolute left-3 top-3 text-gray-400 text-xs"></i>
                            <input type="text" id="filter-keyword" placeholder="Area, nama jalan..." class="w-full pl-9 pr-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:outline-none focus:border-primary transition">
                        </div>
                    </div>

                    <div class="mb-5">
                        <label class="block text-xs font-bold text-gray-500 uppercase tracking-wide mb-2">Tipe Properti</label>
                        <select id="filter-category" class="w-full bg-gray-50 border border-gray-200 text-gray-700 text-sm rounded-lg px-4 py-2.5 focus:ring-primary focus:border-primary transition cursor-pointer">
                            <option value="all">Semua Tipe</option>
                            <option value="Rumah">Rumah</option>
                            <option value="Apartemen">Apartemen</option>
                            <option value="Tanah">Tanah</option>
                            <option value="Kost">Kost</option>
                        </select>
                    </div>

                    <div class="mb-5">
                        <label class="block text-xs font-bold text-gray-500 uppercase tracking-wide mb-2">Range Harga</label>
                        <select id="filter-price" class="w-full bg-gray-50 border border-gray-200 text-gray-700 text-sm rounded-lg px-4 py-2.5 focus:ring-primary focus:border-primary transition cursor-pointer">
                            <option value="any">Semua Harga</option>
                            <option value="under-500">&lt; 500 Juta</option>
                            <option value="500-1000">500 Juta - 1 Milyar</option>
                            <option value="above-1000">&gt; 1 Milyar</option>
                        </select>
                    </div>

                    <div class="grid grid-cols-2 gap-3 mb-6">
                        <div>
                            <label class="block text-[10px] font-bold text-gray-400 mb-1">Kamar Tidur</label>
                            <select id="filter-bed" class="w-full bg-gray-50 border border-gray-200 text-xs rounded px-2 py-2">
                                <option value="any">Bebas</option>
                                <option value="1">1+</option>
                                <option value="2">2+</option>
                                <option value="3">3+</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-[10px] font-bold text-gray-400 mb-1">Urutkan</label>
                            <select id="sort-order" class="w-full bg-gray-50 border border-gray-200 text-xs rounded px-2 py-2">
                                <option value="newest">Terbaru</option>
                                <option value="low-price">Harga Terendah</option>
                                <option value="high-price">Harga Tertinggi</option>
                            </select>
                        </div>
                    </div>

                    <button onclick="applyFilter()" class="w-full bg-btn-green hover:bg-green-800 text-white font-bold py-3 rounded-lg shadow-md transition text-sm flex justify-center items-center gap-2">
                        <i class="fa-solid fa-filter"></i> Terapkan Filter
                    </button>
                    
                    <button onclick="resetFilter()" class="w-full mt-3 text-gray-400 text-xs font-medium hover:text-primary transition underline">
                        Reset Filter
                    </button>
                </div>
            </aside>

            <div class="lg:col-span-3">
                <div class="flex justify-between items-end mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Daftar Properti</h2>
                        <p class="text-sm text-gray-500 mt-1">Menampilkan <span id="showing-count" class="font-bold text-primary">0</span> properti</p>
                    </div>
                </div>

                <div id="property-list" class="grid grid-cols-1 md:grid-cols-2 gap-6 min-h-[400px]"></div>
                <div id="pagination-container" class="flex justify-center mt-12 gap-2"></div>
            </div>
        </div>
    </main>

    <footer class="bg-primary text-white pt-16 pb-8 border-t-4 border-secondary">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2026 Malang Property Hub. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        const propertiesData = [
            { id: 1, title: "Rumah Baru 2 Lantai Mewah", price: 750000000, category: "Rumah", location: "Lowokwaru, Malang", beds: 3, baths: 2, area: 120, image: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?q=80&w=1074&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", badge: "Terbaru" },
            { id: 2, title: "Tanah Kavling Siap Bangun", price: 360000000, category: "Tanah", location: "Dau, Kab. Malang", beds: 0, baths: 0, area: 200, image: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&w=800&q=80", badge: "" },
            { id: 3, title: "Apartemen Suhat Full Furnish", price: 600000000, category: "Apartemen", location: "Soekarno Hatta, Malang", beds: 2, baths: 1, area: 45, image: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?auto=format&fit=crop&w=800&q=80", badge: "Hot Deal" },
            { id: 4, title: "Rumah Minimalis Araya", price: 1200000000, category: "Rumah", location: "Araya, Malang", beds: 4, baths: 3, area: 150, image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&w=800&q=80", badge: "" },
            { id: 5, title: "Kost Eksklusif Dekat UB", price: 2500000000, category: "Kost", location: "Ketawanggede, Malang", beds: 10, baths: 10, area: 200, image: "https://images.unsplash.com/photo-1596276020587-8044fe049813?auto=format&fit=crop&w=800&q=80", badge: "Investasi" },
            { id: 6, title: "Tanah View Pegunungan", price: 450000000, category: "Tanah", location: "Batu, Jawa Timur", beds: 0, baths: 0, area: 300, image: "https://images.unsplash.com/photo-1718723570759-5c9d9693ffb0?q=80&w=1175&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", badge: "" },
            { id: 7, title: "Rumah Subsidi Karangploso", price: 160000000, category: "Rumah", location: "Karangploso, Malang", beds: 2, baths: 1, area: 60, image: "https://images.unsplash.com/photo-1572120360610-d971b9d7767c?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", badge: "Subsidi" },
            { id: 8, title: "Ruko Poros Jalan", price: 1500000000, category: "Rumah", location: "Klojen, Malang", beds: 2, baths: 2, area: 100, image: "https://images.unsplash.com/photo-1568605114967-8130f3a36994?auto=format&fit=crop&w=800&q=80", badge: "Usaha" }
        ];

        let currentPage = 1;
        const itemsPerPage = 4;
        let currentFilteredData = [...propertiesData];

        const formatRupiah = (number) => {
            if (number >= 1000000000) return "Rp " + (number / 1000000000).toFixed(1) + " M";
            if (number >= 1000000) return "Rp " + (number / 1000000).toFixed(0) + " Jt";
            return "Rp " + number.toLocaleString('id-ID');
        };

        function renderProperties() {
            const container = document.getElementById('property-list');
            const countLabel = document.getElementById('showing-count');
            
            const totalItems = currentFilteredData.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            if (currentPage > totalPages) currentPage = totalPages > 0 ? totalPages : 1;
            
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const itemsToShow = currentFilteredData.slice(start, end);

            countLabel.innerText = `${start + 1}-${Math.min(end, totalItems)} dari ${totalItems}`;
            
            if (itemsToShow.length === 0) {
                container.innerHTML = `<div class="col-span-full text-center py-10 bg-white rounded-lg shadow-sm"><i class="fa-regular fa-folder-open text-4xl text-gray-300 mb-3"></i><p class="text-gray-500">Tidak ada properti yang ditemukan.</p></div>`;
            } else {
                container.innerHTML = itemsToShow.map(item => `
                    <div class="bg-white rounded-xl overflow-hidden shadow-soft hover:shadow-lg transition duration-300 group flex flex-col h-full border border-gray-100">
                        <div class="relative h-52 overflow-hidden">
                            <img src="${item.image}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500" alt="${item.title}">
                            <div class="absolute top-3 left-3 bg-primary/90 text-white text-[10px] font-bold px-2 py-1 rounded backdrop-blur-sm uppercase tracking-wider">${item.category}</div>
                            ${item.badge ? `<div class="absolute top-3 right-3 bg-secondary text-white text-[10px] font-bold px-2 py-1 rounded shadow-sm">${item.badge}</div>` : ''}
                        </div>
                        <div class="p-5 flex flex-col flex-grow">
                            <h3 class="text-xl font-bold text-primary mb-1">${formatRupiah(item.price)}</h3>
                            <h4 class="font-semibold text-gray-800 text-sm leading-snug mb-2 line-clamp-2 min-h-[40px]">${item.title}</h4>
                            <div class="text-xs text-gray-500 mb-4 flex items-center gap-1"><i class="fa-solid fa-location-dot text-secondary"></i> ${item.location}</div>
                            <div class="mt-auto pt-3 border-t border-gray-100">
                                <div class="flex justify-between text-xs text-gray-500 font-medium mb-4">
                                    ${item.category !== 'Tanah' ? `<span class="flex items-center gap-1"><i class="fa-solid fa-bed"></i> ${item.beds} KT</span>` : ''}
                                    ${item.category !== 'Tanah' ? `<span class="flex items-center gap-1"><i class="fa-solid fa-bath"></i> ${item.baths} KM</span>` : ''}
                                    <span class="flex items-center gap-1"><i class="fa-solid fa-vector-square"></i> ${item.area} mÂ²</span>
                                </div>
                                <div class="flex gap-2">
                                    <a href="detail-properti.html?id=${item.id}" class="flex-1 bg-blue-50 text-center flex justify-center items-center text-primary hover:bg-primary hover:text-white text-xs font-bold py-2 rounded transition">Detail</a>
                                    
                                    <a href="https://wa.me/6281234567890?text=Halo admin, saya tertarik dengan properti: ${encodeURIComponent(item.title)} (${formatRupiah(item.price)})" target="_blank" class="flex-1 bg-btn-green text-white hover:bg-green-700 text-xs font-bold py-2 rounded transition flex items-center justify-center gap-1">
                                        <i class="fa-brands fa-whatsapp"></i> Kontak
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            renderPagination(totalPages);
        }

        function renderPagination(totalPages) {
            const container = document.getElementById('pagination-container');
            if (totalPages <= 1) { container.innerHTML = ''; return; }
            let html = `<button onclick="changePage(${currentPage - 1})" class="w-8 h-8 flex items-center justify-center rounded bg-white text-gray-600 shadow-sm hover:bg-gray-100 ${currentPage === 1 ? 'opacity-50 cursor-not-allowed' : ''}" ${currentPage === 1 ? 'disabled' : ''}><i class="fa-solid fa-chevron-left text-xs"></i></button>`;
            for (let i = 1; i <= totalPages; i++) {
                html += `<button onclick="changePage(${i})" class="w-8 h-8 flex items-center justify-center rounded ${i === currentPage ? 'bg-secondary text-white font-bold' : 'bg-white text-gray-600 font-medium hover:bg-gray-100'} shadow-sm text-sm">${i}</button>`;
            }
            html += `<button onclick="changePage(${currentPage + 1})" class="w-8 h-8 flex items-center justify-center rounded bg-white text-gray-600 shadow-sm hover:bg-gray-100 ${currentPage === totalPages ? 'opacity-50 cursor-not-allowed' : ''}" ${currentPage === totalPages ? 'disabled' : ''}><i class="fa-solid fa-chevron-right text-xs"></i></button>`;
            container.innerHTML = html;
        }

        function applyFilter() {
            const keyword = document.getElementById('filter-keyword').value.toLowerCase();
            const category = document.getElementById('filter-category').value;
            const priceRange = document.getElementById('filter-price').value;
            const bed = document.getElementById('filter-bed').value;
            const sortOrder = document.getElementById('sort-order').value;

            currentFilteredData = propertiesData.filter(item => {
                const matchKeyword = item.title.toLowerCase().includes(keyword) || item.location.toLowerCase().includes(keyword);
                const matchCategory = category === 'all' || item.category === category;
                
                let matchPrice = true;
                if (priceRange === 'under-500') matchPrice = item.price < 500000000;
                else if (priceRange === '500-1000') matchPrice = item.price >= 500000000 && item.price <= 1000000000;
                else if (priceRange === 'above-1000') matchPrice = item.price > 1000000000;

                let matchBed = true;
                if (bed !== 'any' && item.category !== 'Tanah') {
                    if (bed === '3') matchBed = item.beds >= 3;
                    else matchBed = item.beds == bed;
                }

                return matchKeyword && matchCategory && matchPrice && matchBed;
            });

            if (sortOrder === 'low-price') currentFilteredData.sort((a, b) => a.price - b.price);
            else if (sortOrder === 'high-price') currentFilteredData.sort((a, b) => b.price - a.price);
            else currentFilteredData.sort((a, b) => b.id - a.id);

            currentPage = 1;
            renderProperties();
        }

        function resetFilter() {
            document.getElementById('filter-keyword').value = '';
            document.getElementById('filter-category').value = 'all';
            document.getElementById('filter-price').value = 'any';
            document.getElementById('filter-bed').value = 'any';
            document.getElementById('sort-order').value = 'newest';
            applyFilter();
        }

        function changePage(page) {
            currentPage = page;
            renderProperties();
            document.getElementById('property-list').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // --- INIT: LOAD DATA DARI URL PARAMETER (DARI INDEX.HTML) ---
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            
            if (params.has('loc')) document.getElementById('filter-keyword').value = params.get('loc');
            if (params.has('type')) document.getElementById('filter-category').value = params.get('type');
            if (params.has('price')) document.getElementById('filter-price').value = params.get('price');

            // Apply filter langsung saat halaman dibuka
            applyFilter();

            // Mobile menu listener
            document.getElementById('mobile-btn').addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.toggle('hidden');
            });
        });
    </script>
</body>
</html>